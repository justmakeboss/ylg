document.write("<script type=\"text/javascript\" src=\"http://api.map.baidu.com/api?v=2.0&ak=9lRKYm2o13BVxHQQggodnEFz\"><\/script>"); function initBaiDuMap(j) { if (!j.hasOwnProperty("map")) { j.map = "baidu-map" } if (!j.hasOwnProperty("defaultCountry")) { j.defaultCountry = "广州市" } if (!j.hasOwnProperty("point")) { j.point = { lng: 113.270793, lat: 23.135308 } } if (!j.hasOwnProperty("openInfo")) { j.openInfo = true } if (!j.hasOwnProperty("autoSearch")) { j.autoSearch = "baidu-auto-txt" } else { if (!j.autoSearch || j.autoSearch == "" || j.autoSearch == null) { j.autoSearch = false } } this.baidu_Map; this.autoComplete = function (k) { b(k) }; function g(k) { c(); var l = new BMap.Marker(k); this.baidu_Map.addOverlay(l); l.enableDragging(); i(l); var m = l.getPosition(); j.pointOut({ lng: m.lng, lat: m.lat }); a(k, l) } function i(k) { k.addEventListener("dragend", function (l) { g(l.point) }) } function h() { var k = new BMap.ScaleControl({ anchor: BMAP_ANCHOR_BOTTOM_LEFT }); k.setUnit(BMAP_UNIT_METRIC); this.baidu_Map.addControl(k); var l = new BMap.NavigationControl({ anchor: BMAP_ANCHOR_TOP_LEFT, type: 0 }); this.baidu_Map.addControl(l); var m = new BMap.OverviewMapControl({ anchor: BMAP_ANCHOR_BOTTOM_RIGHT, isOpen: false }); this.baidu_Map.addControl(m) } function c() { this.baidu_Map.clearOverlays() } function b(k) { var l = new BMap.Geocoder(); l.getPoint(k, function (m) { if (m) { this.baidu_Map.centerAndZoom(m, 16); g(m) } else { alert("无法找到该地区") } }, "全国") } function a(k, m) { var l = new BMap.Geocoder(); l.getLocation(k, function (n) { var p = n.addressComponents; var o = p.province + p.city + p.district + p.street + p.streetNumber; j.addrOut(p); if (!j.openInfo) { return } m.openInfoWindow(f(o)) }) } function d(o) { var n = new BMap.Autocomplete({ "input": j.autoSearch, "location": this.baidu_Map }); function m(p) { return document.getElementById(j.autoSearch) } n.setInputValue(o); n.addEventListener("onhighlight", function (r) { var s = ""; var p = r.fromitem.value; var q = ""; if (r.fromitem.index > -1) { q = p.province + p.city + p.district + p.street + p.business } s = "FromItem<br />index = " + r.fromitem.index + "<br />value = " + q; q = ""; if (r.toitem.index > -1) { p = r.toitem.value; q = p.province + p.city + p.district + p.street + p.business } s += "<br />ToItem<br />index = " + r.toitem.index + "<br />value = " + q; m("searchResultPanel").innerHTML = s }); var l; n.addEventListener("onconfirm", function (q) { var p = q.item.value; l = p.province + p.city + p.district + p.street + p.business; m("searchResultPanel").innerHTML = "onconfirm<br />index = " + q.item.index + "<br />myValue = " + l; k() }); function k() { this.baidu_Map.clearOverlays(); function p() { var r = q.getResults().getPoi(0).point; this.baidu_Map.centerAndZoom(r, 18); g(r) } var q = new BMap.LocalSearch(this.baidu_Map, { onSearchComplete: p }); q.search(l) } } function f(m) { var l = { width: 200, title: "详细位置", enableMessage: true, }; var k = new BMap.InfoWindow(m, l); return k } function e() { this.baidu_Map = new BMap.Map(j.map); var k = new BMap.Point(j.point.lng, j.point.lat); this.baidu_Map.centerAndZoom(k, 18); var l = new BMap.Marker(k); this.baidu_Map.addOverlay(l); l.enableDragging(); i(l); this.baidu_Map.addEventListener("click", function (m) { g(m.point) }); this.baidu_Map.addEventListener("dragend", function (m) { g(m.point) }); h(); if (!j.autoSearch) { d(j.defaultCountry) } else { if (j.autoSearch != "") { d(j.defaultCountry) } } if (!j.openInfo) { return } l.openInfoWindow(f(j.defaultCountry)) } e() };
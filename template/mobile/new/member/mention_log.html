<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0,viewport-fit=cover">
<link rel="stylesheet" href="__STATIC__/assets/dist/assets/css/zpui.css"/>
<link rel="stylesheet" href="__STATIC__/assets/dist/assets/css/all.css"/>
<script src="__STATIC__/assets/dist/assets/js/page.js"></script>

    <title> 提货明细 </title>
</head>
<body>
<div class="page">
    <div class="page-hd">
        <div class="header bor-1px-b">
    <div class="header-left">
        <a href="javascript:history.go(-1)" class="left-arrow"></a>
    </div>
    <div class="header-title">提货明细</div>
    <div class="header-right">
        <a href="#"></a>
    </div>
</div>
    </div>

    <div class="page-bd">
        <!-- 页面内容-->

        <div class="pmgeyt">
            <div class="weui-cells tr oveterm pmer">
                <div class="weui-celly" id="div_sn">
                    <div class="weui-cell__hd">商品代码 </div>
                    <!--<div class="weui-cell__hd">L545 </div>-->
                    <!--<div class="weui-cell__hd">L545 </div>-->
                    <!--<div class="weui-cell__hd">L545 </div>-->
                    <!--<div class="weui-cell__hd">L545 </div>-->
                    <!--<div class="weui-cell__hd">L545 </div>-->
                    <!--<div class="weui-cell__hd">L545 </div>-->
                </div>
                <div class="weui-celly" id="div_name">
                    <div class="weui-cell__hd">商品名称</div>
                    <!--<div class="weui-cell__hd">美素佳儿奶粉 </div>-->
                    <!--<div class="weui-cell__hd">美素佳儿奶粉 </div>-->
                    <!--<div class="weui-cell__hd">美素佳儿奶粉 </div>-->
                    <!--<div class="weui-cell__hd">美素佳儿奶粉 </div>-->
                    <!--<div class="weui-cell__hd">美素佳儿奶粉</div>-->
                    <!--<div class="weui-cell__hd">美素佳儿奶粉</div>-->
                </div>
                <div class="weui-celly" id="div_setmeal">
                    <div class="weui-cell__hd">套餐</div>
                    <!--<div class="weui-cell__hd">套餐1 </div>-->
                    <!--<div class="weui-cell__hd">套餐1 </div>-->
                    <!--<div class="weui-cell__hd">套餐1 </div>-->
                    <!--<div class="weui-cell__hd">套餐1 </div>-->
                    <!--<div class="weui-cell__hd">套餐1 </div>-->
                    <!--<div class="weui-cell__hd">套餐1 </div>-->
                </div>
                <div class="weui-celly" id="div_num">
                    <div class="weui-cell__hd">提货数量</div>
                    <!--<div class="weui-cell__hd">10 </div>-->
                    <!--<div class="weui-cell__hd">10 </div>-->
                    <!--<div class="weui-cell__hd">10 </div>-->
                    <!--<div class="weui-cell__hd">10</div>-->
                    <!--<div class="weui-cell__hd">10 </div>-->
                    <!--<div class="weui-cell__hd">10 </div>-->
                </div>
                <div class="weui-celly" id="div_type">
                    <div class="weui-cell__hd">提货方式</div>
                    <!--<div class="weui-cell__hd">0.00 </div>-->
                    <!--<div class="weui-cell__hd">0.00 </div>-->
                    <!--<div class="weui-cell__hd">0.00 </div>-->
                    <!--<div class="weui-cell__hd">0.00 </div>-->
                    <!--<div class="weui-cell__hd">0.00 </div>-->
                    <!--<div class="weui-cell__hd">0.00 </div>-->
                </div>
                <div class="weui-celly" id="div_user">
                    <div class="weui-cell__hd">提货人信息</div>
                    <!--<div class="weui-cell__hd">自提</div>-->
                    <!--<div class="weui-cell__hd">自提 </div>-->
                    <!--<div class="weui-cell__hd">自提 </div>-->
                    <!--<div class="weui-cell__hd">自提</div>-->
                    <!--<div class="weui-cell__hd">自提</div>-->
                    <!--<div class="weui-cell__hd">自提 </div>-->
                </div>
                <div class="weui-celly" id="div_create">
                    <div class="weui-cell__hd">申请时间</div>
                    <!--<div class="weui-cell__hd">12-11-03 </div>-->
                    <!--<div class="weui-cell__hd">12-11-03 </div>-->
                    <!--<div class="weui-cell__hd">12-11-03 </div>-->
                    <!--<div class="weui-cell__hd">12-11-03 </div>-->
                    <!--<div class="weui-cell__hd">12-11-03 </div>-->
                    <!--<div class="weui-cell__hd">12-11-03 </div>-->
                </div>
                <div class="weui-celly" id="div_status">
                    <div class="weui-cell__hd">发货状态</div>
                    <!--<div class="weui-cell__hd">已发货 </div>-->
                    <!--<div class="weui-cell__hd">已发货 </div>-->
                    <!--<div class="weui-cell__hd">已发货 </div>-->
                    <!--<div class="weui-cell__hd">已发货 </div>-->
                    <!--<div class="weui-cell__hd">已发货 </div>-->
                    <!--<div class="weui-cell__hd">已发货 </div>-->
                </div>
                <div class="weui-celly" id="div_cz">
                    <div class="weui-cell__hd">操作 </div>
                    <!--<div class="weui-cell__hd"><a class="yuer" href="###">已提货</a> </div>-->
                    <!--<div class="weui-cell__hd"><a class="yuer" href="###">已提货</a></div>-->
                    <!--<div class="weui-cell__hd"><a class="yuer" href="###">已提货</a></div>-->
                    <!--<div class="weui-cell__hd"><a class="yuer" href="###">已提货</a></div>-->
                    <!--<div class="weui-cell__hd"><a class="yuer acter" href="###">已提货</a></div>-->
                    <!--<div class="weui-cell__hd"><a class="yuer" href="###">已提货</a></div>-->
                </div>
            </div>
        </div>
    </div>

</div>
<script src="__STATIC__/assets/dist/assets/js/lib/jquery-2.1.4.js"></script>
<script src="__STATIC__/assets/dist/assets/js/jquery-weui.min.js"></script>
<script src="__STATIC__/assets/dist/assets/js/lib/fastclick.js"></script>
<script>
  $(function() {
    FastClick.attach(document.body);
  });
</script>

<script src="__STATIC__/assets/dist/assets/js/Swiper-4.0.7/swiper.min.js"></script>
<script>
var swiper = new Swiper('.swiper-container', {
    pagination: {
        el: '.swiper-pagination',
        type: 'fraction',
    },
});
 function edit(id){
     // console.log(id);return false;
     $.post('/Mobile/Member/mention_log/',{'act':'edit','id':id},function(data){
         if(data.code == 1){
             $.toast('收货成功!');
             location.reload();
         }else{
             $.toast(data.msg);
         }
     })
 }
// 当前页数
  var p = 0;
  // 加载完毕标志
  var endflg =  0;
  // 防止重复加载
  var busy = false;
  loadMore();
  function loadMore(){

      if(endflg == 0) {
          $.ajax({
              type: 'post',
              url: "{:U('Mobile/Member/mention_log')}",
              dataType: 'JSON',
              data: {'p':p},
              success: function (data) {

                  // console.log(data); return false;
                  if (data.code == 1) {
                      var div_sn = '', div_cz = '', div_status = '', div_create= '',div_name = '', div_num = '', div_type= '', div_user = '', div_setmeal = '';
                      if(data.data != '' && data.data != null){
                          if( p > 0) {
                              // $.toast("正在加载");
                              // layer.msg("正在加载...", {time: 500});
                          }
                      } else {
                          // $.toast("已经全部加载完了");
                          // layer.msg("已经全部加载完了...", {time:500});
                          var endflg = 1;
                          return false;
                      }
                      p++;
                      $(data.data).each(function (index, element) {
                          var id = element['mention_id'];
                          console.log(id);
                          // console.log(index);
                          // console.log(element);
                          div_sn += '<div class="weui-cell__hd">' + element['goods_sn'] + '</div>';
                          div_status += '<div class="weui-cell__hd">' + element['status'] + '</div>';
                          div_name += '<div class="weui-cell__hd">' + element['goods_name'] + '</div>';
                          div_create += '<div class="weui-cell__hd">' + element['create_time'] + '</div>';
                          div_num += '<div class="weui-cell__hd">' + element['num'] + '</div>';
                          div_type += '<div class="weui-cell__hd">自提</div>';
                          div_setmeal += '<div class="weui-cell__hd">' + element['name'] + '</div>';
                          div_user += '<div class="weui-cell__hd">' + element['consignee'] + '</div>';
                          // console.log(div_name);
                          // console.log(div_name);
                          // 已完成
                        if(element['status'] == 3){
                            div_cz += '<div class="weui-cell__hd"><a class="yuer acter">已收货</a></div>';
                        }else if(element['status'] == 2){
                            div_cz += '<div class="weui-cell__hd"><a class="yuer" onclick="edit('+id+')">确认收货</a></div>';
                        }else{
                            div_cz += '<div class="weui-cell__hd"><a class="yuer acter" >待发货</a></div>';
                        }

                      })
                      console.log(div_sn);
                      $('#div_sn').append(div_sn);
                      $('#div_status').append(div_status);
                      $('#div_name').append(div_name);
                      $('#div_create').append(div_create);
                      $('#div_num').append(div_num);
                      $('#div_type').append(div_type);
                      $('#div_setmeal').append(div_setmeal);
                      $('#div_user').append(div_user);
                      $('#div_cz').append(div_cz);
                      // console.log(data.url);return false;
                      // layer.open({content:data.msg,time:2,end:function(){
                      //         window.location.href='/Mobile/Order/order_list';
                      //     }});
                  } else {
                      $.alert(data);
                      // layer.open({content: data.msg, time: 2});
                  }
              },
              error: function () {
                  $.toast(请稍后再试);
                  // layer.open({content: '请稍后再试', time: 2});
              }
          })
      }else{
          $.toast('已经全部加载完了');
          // layer.msg("已经全部加载完了...", {time:500});
      }

  }

  // $('.page-bd').scroll(function(){
  //     var scrollTop = $(this).scrollTop();
  //     var box = $('.page-hd').height();
  //
  //     var scrollHeights = $(document).height();
  //     var scrollHeight = $(this).height();
  //
  //     console.log(box);
  //     console.log(scrollTop);
  //     console.log(scrollHeights);
  //     console.log(scrollHeight);
  //     // loadMore();
  //     ;return false;
  //     if(scrollTop >= box){
  //         loadMore();
  //     }
  var loading = false;  //状态标记
  $('.page-bd').infinite().on("infinite", function() {
      if(loading) return;
      loading = true;
      setTimeout(function() {
          loadMore();
          loading = false;
      }, 1500);   //模拟延迟
  });
</script>

</body>
</html>